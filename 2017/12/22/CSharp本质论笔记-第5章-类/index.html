<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="xdf_EYOTcZ4RxK4c0hOFNBzrbcz5Njm7wB6c0eHU_z8" />














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.ico?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.ico?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="C#,C#本质论,Essential C#," />





  <link rel="alternate" href="/atom.xml" title="慢读慢写" type="application/atom+xml" />






<meta name="description" content="类的定义和实例化使用类，可以通过组合其他类型的变量、方法和事件创建自己的自定义类型。A class is a construct that enables you to create your own custom types by grouping together variables of other types, methods and events. 类好比是蓝图。A class is l">
<meta name="keywords" content="C#,C#本质论,Essential C#">
<meta property="og:type" content="article">
<meta property="og:title" content="C#本质论笔记 第5章 类">
<meta property="og:url" content="http://slowread.cn/2017/12/22/CSharp本质论笔记-第5章-类/index.html">
<meta property="og:site_name" content="慢读慢写">
<meta property="og:description" content="类的定义和实例化使用类，可以通过组合其他类型的变量、方法和事件创建自己的自定义类型。A class is a construct that enables you to create your own custom types by grouping together variables of other types, methods and events. 类好比是蓝图。A class is l">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-12-24T09:13:45.894Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="C#本质论笔记 第5章 类">
<meta name="twitter:description" content="类的定义和实例化使用类，可以通过组合其他类型的变量、方法和事件创建自己的自定义类型。A class is a construct that enables you to create your own custom types by grouping together variables of other types, methods and events. 类好比是蓝图。A class is l">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://slowread.cn/2017/12/22/CSharp本质论笔记-第5章-类/"/>





  <title>C#本质论笔记 第5章 类 | 慢读慢写</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-111158836-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?46b7e3c75c64743d47bf2a07805918be";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">慢读慢写</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">漫漫人生</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            日志
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'os7Q-RV2ULnwtX9CGxR2','2.0.0');
</script>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://slowread.cn/2017/12/22/CSharp本质论笔记-第5章-类/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="At2008">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="慢读慢写">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">C#本质论笔记 第5章 类</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-22T13:20:40+08:00">
                2017-12-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/12/22/CSharp本质论笔记-第5章-类/" class="leancloud_visitors" data-flag-title="C#本质论笔记 第5章 类">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="类的定义和实例化"><a href="#类的定义和实例化" class="headerlink" title="类的定义和实例化"></a>类的定义和实例化</h1><p>使用类，可以通过组合其他类型的变量、方法和事件创建自己的自定义类型。A <em>class</em> is a construct that enables you to create your own custom types by grouping together variables of other types, methods and events. 类好比是蓝图。A class is like a blueprint. 它定义类型的数据和行为。It defines the data and behavior of a type. 如果类未声明为静态，客户端代码就可以通过创建分配给变量的<em>对象</em>或<em>实例</em>来使用该类。If the class is not declared as static, client code can use it by creating <em>objects</em> or <em>instances</em> which are assigned to a variable. 变量会一直保留在内存中，直至对变量的所有引用超出范围为止。The variable remains in memory until all references to it go out of scope. 超出范围时，CLR 将对其进行标记，以便用于垃圾回收。At that time, the CLR marks it as eligible for garbage collection. 如果类声明为<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/static" target="_blank" rel="noopener">静态</a>，则内存中只有一个副本，且客户端代码只能通过类本身，而不是<em>实例变量</em>来访问它。If the class is declared as <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/static" target="_blank" rel="noopener">static</a>, then only one copy exists in memory and client code can only access it through the class itself, not an <em>instance variable</em>. 有关详细信息，请参阅<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/programming-guide/classes-and-structs/static-classes-and-static-class-members" target="_blank" rel="noopener">静态类和静态类成员</a>。For more information, see <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/programming-guide/classes-and-structs/static-classes-and-static-class-members" target="_blank" rel="noopener">Static Classes and Static Class Members</a>.</p>
<p>与结构不同，类支持<em>继承</em>，这是面向对象的编程的一个基本特点。Unlike structs, classes support <em>inheritance</em>, a fundamental characteristic of object-oriented programming. 有关详细信息，请参阅<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/programming-guide/classes-and-structs/inheritance" target="_blank" rel="noopener">继承</a>。</p>
<a id="more"></a>
<blockquote>
<p>例子，包含类的定义、实例化、字段声明、字段访问和方法：</p>
</blockquote>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        Employee employee1 = <span class="keyword">new</span> Employee ();</span><br><span class="line">        Employee employee2;</span><br><span class="line">        employee2 = <span class="keyword">new</span> Employee ();</span><br><span class="line"></span><br><span class="line">        employee1.FirstName = <span class="string">"Inigo"</span>;</span><br><span class="line">        employee1.LastName = <span class="string">"Montoya"</span>;</span><br><span class="line">        employee1.Salary = <span class="string">"Too Little"</span>;</span><br><span class="line">        IncreaseSalary (employee1);</span><br><span class="line">        Console.WriteLine (<span class="string">"&#123;0&#125;: &#123;1&#125;"</span>, employee1.GetName (), employee1.Salary);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">IncreaseSalary</span> (<span class="params">Employee employee</span>) </span>&#123;</span><br><span class="line">        employee.Salary = <span class="string">"Enough to survive on"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> FirstName;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> LastName;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Salary = <span class="string">"Not enough"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">string</span> <span class="title">GetName</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> FirstName + <span class="string">" "</span> + LastName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&lt;&gt;</p>
<h1 id="this-关键字"><a href="#this-关键字" class="headerlink" title="this 关键字"></a>this 关键字</h1><p><code>this</code> 关键字指代类的当前实例。在此示例中，<code>this</code> 用于限定类似名称隐藏的 <code>Employee</code> 类成员、<code>name</code> 和 <code>alias</code>。In this example, <code>this</code> is used to qualify the <code>Employee</code> class members, <code>name</code> and <code>alias</code>, which are hidden by similar names. 它还用于将某个对象传递给属于其他类的方法 <code>CalcTax</code>。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> <span class="keyword">alias</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">decimal</span> salary = <span class="number">3000.00</span>m;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Constructor:</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span> (<span class="params"><span class="keyword">string</span> name, <span class="keyword">string</span> <span class="keyword">alias</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Use this to qualify the fields, name and alias:</span></span><br><span class="line">        <span class="comment">// 如果不用 this 指定类成员 name，那么 name = name; 只是自己给自己赋值，</span></span><br><span class="line">        <span class="comment">// 最终，类成员 name 未被赋值，为 null</span></span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.<span class="keyword">alias</span> = <span class="keyword">alias</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Printing method:</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printEmployee</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        Console.WriteLine (<span class="string">"Name: &#123;0&#125;\nAlias: &#123;1&#125;"</span>, name, <span class="keyword">alias</span>);</span><br><span class="line">        <span class="comment">// Passing the object to the CalcTax method by using this:</span></span><br><span class="line">        Console.WriteLine (<span class="string">"Taxes: &#123;0:C&#125;"</span>, Tax.CalcTax (<span class="keyword">this</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">decimal</span> Salary &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> salary; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Tax</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">decimal</span> <span class="title">CalcTax</span> (<span class="params">Employee E</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0.08</span>m * E.Salary;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">MainClass</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Create objects:</span></span><br><span class="line">        Employee E1 = <span class="keyword">new</span> Employee (<span class="string">"Mingda Pan"</span>, <span class="string">"mpan"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Display results:</span></span><br><span class="line">        E1.printEmployee ();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Output:</span></span><br><span class="line"><span class="comment">    Name: Mingda Pan</span></span><br><span class="line"><span class="comment">    Alias: mpan</span></span><br><span class="line"><span class="comment">    Taxes: $240.00</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<h1 id="高级主题：存储和载入文件"><a href="#高级主题：存储和载入文件" class="headerlink" title="高级主题：存储和载入文件"></a>高级主题：存储和载入文件</h1><h2 id="将数据持久化存储到文件"><a href="#将数据持久化存储到文件" class="headerlink" title="将数据持久化存储到文件"></a>将数据持久化存储到文件</h2><blockquote>
<p>示例：首先，实例化一个<code>FileStream</code>对象，将它与一个以员工的全名命名的文件对应起来。<code>FileMode.Create</code>参数指明，如果对应的文件不存在就创建一个；如果文件存在，就覆盖它。接着创建一个<code>StreamWriter</code>类。StreamWriter类负责将文本写入<code>FileStream</code>。数据是用<code>WriterLine()</code>方法写入的，就像向控制台写入一样。</p>
</blockquote>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="comment">// IO namespace</span></span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> FirstName;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> LastName;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Salary;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Save</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        DataStorage.Store (<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">DataStorage</span> &#123;</span><br><span class="line">    <span class="comment">// Save an employee object to a file</span></span><br><span class="line">    <span class="comment">// named with the Employee name.</span></span><br><span class="line">    <span class="comment">// Error handling not shown.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Store</span> (<span class="params">Employee employee</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Instantiate a FileStream using FirstNameLastName.dat</span></span><br><span class="line">        <span class="comment">// for the filename. FileMode.Create will force</span></span><br><span class="line">        <span class="comment">// a new file to be created or override an</span></span><br><span class="line">        <span class="comment">// existing file.</span></span><br><span class="line">        FileStream stream = <span class="keyword">new</span> FileStream (</span><br><span class="line">            employee.FirstName + employee.LastName + <span class="string">".dat"</span>,</span><br><span class="line">            FileMode.Create);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Create a StreamWriter object for writing text</span></span><br><span class="line">        <span class="comment">// into the FileStream</span></span><br><span class="line">        StreamWriter writer = <span class="keyword">new</span> StreamWriter (stream);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Write all the data associated with the employee.</span></span><br><span class="line">        writer.WriteLine (employee.FirstName);</span><br><span class="line">        writer.WriteLine (employee.LastName);</span><br><span class="line">        writer.WriteLine (employee.Salary);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Close the StreamWriter and its Stream.</span></span><br><span class="line">        writer.Close (); <span class="comment">// Automatically closes the stream</span></span><br><span class="line">        stream.Close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">SaveDataToFile</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"><span class="keyword">string</span>[] args</span>) </span>&#123;</span><br><span class="line">        Employee employee = <span class="keyword">new</span> Employee ();</span><br><span class="line">        employee.FirstName = <span class="string">"Jon"</span>;</span><br><span class="line">        employee.LastName = <span class="string">"Snow"</span>;</span><br><span class="line">        employee.Salary = <span class="string">"$6000.00"</span>;</span><br><span class="line">        employee.Save ();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>写入操作完成后，<code>FileStream</code>和<code>StreamWriter</code>都需要关闭，避免它们在等待垃圾回收器运行期间，处于“不确定性打开”的状态。上述代码没有任何错误处理机制，如果引发异常，两个<code>Close()</code>方法都不会执行。</p>
<h2 id="从文件中获取数据"><a href="#从文件中获取数据" class="headerlink" title="从文件中获取数据"></a>从文件中获取数据</h2><p>读取数据与存储数据相反，它使用StreamReader而不是StreamWriter。同样的，一旦数据读取完毕，就要在FileStream和StreamReader上调用Close()方法。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        Employee employee1;</span><br><span class="line"></span><br><span class="line">        Employee employee2 = <span class="keyword">new</span> Employee ();</span><br><span class="line">        employee2.SetName (<span class="string">"Inigo"</span>, <span class="string">"Montoya"</span>);</span><br><span class="line">        employee2.Save ();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Modify employee2 after saving.</span></span><br><span class="line">        IncreaseSalary (employee2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Load employee1 from the saved version of employee2</span></span><br><span class="line">        employee1 = DataStorage.Load (<span class="string">"Inigo"</span>, <span class="string">"Montoya"</span>);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine (</span><br><span class="line">            <span class="string">"&#123;0&#125;: &#123;1&#125;"</span>,</span><br><span class="line">            employee1.GetName (),</span><br><span class="line">            employee1.Salary);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">IncreaseSalary</span> (<span class="params">Employee employee</span>) </span>&#123;</span><br><span class="line">        employee.Salary = <span class="string">"Enough to survive on"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> FirstName;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> LastName;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Salary;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">string</span> <span class="title">GetName</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> FirstName + <span class="string">" "</span> + LastName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetName</span> (<span class="params"><span class="keyword">string</span> newFirstName, <span class="keyword">string</span> newLastName</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.FirstName = newFirstName;</span><br><span class="line">        <span class="keyword">this</span>.LastName = newLastName;</span><br><span class="line">        Console.WriteLine (<span class="string">"Name changed to '&#123;0&#125;'"</span>,</span><br><span class="line">            <span class="keyword">this</span>.GetName ());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Save</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        DataStorage.Store (<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">DataStorage</span> &#123;</span><br><span class="line">    <span class="comment">// Save an employee object to a file </span></span><br><span class="line">    <span class="comment">// named with the Employee name.</span></span><br><span class="line">    <span class="comment">// Error handling not shown.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Store</span> (<span class="params">Employee employee</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Instantiate a FileStream using FirstNameLastName.dat</span></span><br><span class="line">        <span class="comment">// for the filename. FileMode.Create will force</span></span><br><span class="line">        <span class="comment">// a new file to be created or override an</span></span><br><span class="line">        <span class="comment">// existing file.</span></span><br><span class="line">        FileStream stream = <span class="keyword">new</span> FileStream (</span><br><span class="line">            employee.FirstName + employee.LastName + <span class="string">".dat"</span>,</span><br><span class="line">            FileMode.Create);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Create a StreamWriter object for writing text</span></span><br><span class="line">        <span class="comment">// into the FileStream</span></span><br><span class="line">        StreamWriter writer = <span class="keyword">new</span> StreamWriter (stream);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Write all the data associated with the employee.</span></span><br><span class="line">        writer.WriteLine (employee.FirstName);</span><br><span class="line">        writer.WriteLine (employee.LastName);</span><br><span class="line">        writer.WriteLine (employee.Salary);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Close the StreamWriter and its Stream.</span></span><br><span class="line">        writer.Close (); <span class="comment">// Automatically closes the stream</span></span><br><span class="line">        stream.Close ();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Employee <span class="title">Load</span> (<span class="params"><span class="keyword">string</span> firstName, <span class="keyword">string</span> lastName</span>) </span>&#123;</span><br><span class="line">        Employee employee = <span class="keyword">new</span> Employee ();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Instantiate a FileStream using FirstNameLastName.dat</span></span><br><span class="line">        <span class="comment">// for the filename. FileMode.Open will open</span></span><br><span class="line">        <span class="comment">// an existing file or else report an error.</span></span><br><span class="line">        FileStream stream = <span class="keyword">new</span> FileStream (</span><br><span class="line">            firstName + lastName + <span class="string">".dat"</span>, FileMode.Open);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Create a SteamReader for reading text from the file.</span></span><br><span class="line">        StreamReader reader = <span class="keyword">new</span> StreamReader (stream);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Read each line from the file and place it into</span></span><br><span class="line">        <span class="comment">// the associated property.</span></span><br><span class="line">        employee.FirstName = reader.ReadLine ();</span><br><span class="line">        employee.LastName = reader.ReadLine ();</span><br><span class="line">        employee.Salary = reader.ReadLine ();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Close the StreamReader and its Stream.</span></span><br><span class="line">        reader.Close (); <span class="comment">// Automatically closes the stream</span></span><br><span class="line">        stream.Close ();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> employee;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="访问修饰符-Access-Modifiers"><a href="#访问修饰符-Access-Modifiers" class="headerlink" title="访问修饰符 Access Modifiers"></a>访问修饰符 Access Modifiers</h1><p>访问修饰符是关键字，用于指定成员或类型已声明的可访问性。Access modifiers are keywords used to specify the declared accessibility of a member or a type. 本部分介绍四个访问修饰符：This section introduces the four access modifiers:</p>
<ul>
<li><p><a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/public" target="_blank" rel="noopener">公用 public</a></p>
</li>
<li><p><a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/protected" target="_blank" rel="noopener">受保护 protected</a></p>
</li>
<li><p><a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/internal" target="_blank" rel="noopener">内部 internal</a></p>
</li>
<li><p><a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/private" target="_blank" rel="noopener">专用 private</a></p>
</li>
</ul>
<p>可以使用访问修饰符指定以下六个可访问性级别：The following six accessibility levels can be specified using the access modifiers:</p>
<p><code>public</code>：访问不受限制。<code>public</code>: Access is not restricted.</p>
<p><code>protected</code>：访问限于包含类或派生自包含类的类型。<code>protected</code>: Access is limited to the containing class or types derived from the containing class.</p>
<p><code>internal</code>：访问限于当前程序集。<code>internal</code>: Access is limited to the current assembly.</p>
<p><a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/protected-internal" target="_blank" rel="noopener"><code>protected internal</code></a>： 访问仅限于当前程序集或从包含类派生的类型。<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/protected-internal" target="_blank" rel="noopener"><code>protected internal</code></a>: Access is limited to the current assembly or types derived from the containing class.</p>
<p><code>private</code>：访问限于包含类。<code>private</code>: Access is limited to the containing type.</p>
<p><a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/private-protected" target="_blank" rel="noopener"><code>private protected</code></a>： 访问被限制为包含的类或从包含当前程序集中的类派生的类型。</p>
<blockquote>
<p>示例：使用<code>private</code>访问修饰符。下例为了隐藏<code>Password</code>字段，禁止从它包容类的外部访问，使用<code>private</code>访问修饰符替代<code>public</code>，这样就无法从<code>Program</code>类中访问<code>Password</code>字段了。</p>
</blockquote>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        Employee employee = <span class="keyword">new</span> Employee ();</span><br><span class="line"></span><br><span class="line">        employee.FirstName = <span class="string">"Inigo"</span>;</span><br><span class="line">        employee.LastName = <span class="string">"Montoya"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Password is private, so it cannot be</span></span><br><span class="line">        <span class="comment">// accessed from outside the class.</span></span><br><span class="line">        <span class="comment">// Console.WriteLine(</span></span><br><span class="line">        <span class="comment">//    ("Password = &#123;0&#125;", employee.Password);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> FirstName;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> LastName;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Salary;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> Password;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">bool</span> IsAuthenticated;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">bool</span> <span class="title">Logon</span> (<span class="params"><span class="keyword">string</span> password</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (Password == password) &#123;</span><br><span class="line">            IsAuthenticated = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> IsAuthenticated;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">bool</span> <span class="title">GetIsAuthenticated</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> IsAuthenticated;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h1><p>属性是一种成员，它提供灵活的机制来读取、写入或计算私有字段的值。A property is a member that provides a flexible mechanism to read, write, or compute the value of a private field. 属性可用作公共数据成员，但它们实际上是称为<em>访问器</em>的特殊方法。Properties can be used as if they are public data members, but they are actually special methods called <em>accessors</em>. 这使得可以轻松访问数据，还有助于提高方法的安全性和灵活性。</p>
<p>属性结合了字段和方法的多个方面。Properties combine aspects of both fields and methods. 对于对象的用户来说，属性似乎是一个字段，访问属性需要相同的语法。To the user of an object, a property appears to be a field, accessing the property requires the same syntax. 对于类的实现者来说，属性是一两个代码块，表示 <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/get" target="_blank" rel="noopener">get</a> 访问器和/或 <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/set" target="_blank" rel="noopener">set</a> 访问器。To the implementer of a class, a property is one or two code blocks, representing a <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/get" target="_blank" rel="noopener">get</a> accessor and/or a <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/set" target="_blank" rel="noopener">set</a> accessor. 读取属性时，执行 <code>get</code> 访问器的代码块；向属性赋予新值时，执行 <code>set</code> 访问器的代码块。The code block for the <code>get</code> accessor is executed when the property is read; the code block for the <code>set</code> accessor is executed when the property is assigned a new value. 将不带 <code>set</code> 访问器的属性视为只读。A property without a <code>set</code> accessor is considered read-only. 将不带 <code>get</code> 访问器的属性视为只写。A property without a <code>get</code> accessor is considered write-only. 将具有以上两个访问器的属性视为读写。A property that has both accessors is read-write.</p>
<p>与字段不同，属性不会被归类为变量。Unlike fields, properties are not classified as variables. 因此，不能将属性作为 <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/ref" target="_blank" rel="noopener">ref</a> 或 <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/out" target="_blank" rel="noopener">out</a> 参数传递。</p>
<h2 id="示例Example"><a href="#示例Example" class="headerlink" title="示例Example"></a>示例Example</h2><p>此示例演示实例、静态和只读属性。This example demonstrates instance, static, and read-only properties. 它接收通过键盘键入的员工姓名，按 1 递增 <code>NumberOfEmployees</code>，并显示员工姓名和编号。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> NumberOfEmployees;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> counter;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// A read-write instance property:</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Name &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> name; &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; name = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// A read-only static property:</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> Counter &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> counter; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// A Constructor:</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Calculate the employee's number:</span></span><br><span class="line">        counter = ++counter + NumberOfEmployees;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">TestEmployee</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        Employee.NumberOfEmployees = <span class="number">107</span>;</span><br><span class="line">        Employee e1 = <span class="keyword">new</span> Employee ();</span><br><span class="line">        e1.Name = <span class="string">"Claude Vige"</span>;</span><br><span class="line"></span><br><span class="line">        System.Console.WriteLine (<span class="string">"Employee number: &#123;0&#125;"</span>, Employee.Counter);</span><br><span class="line">        System.Console.WriteLine (<span class="string">"Employee name: &#123;0&#125;"</span>, e1.Name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">    Employee number: 108</span></span><br><span class="line"><span class="comment">    Employee name: Claude Vige</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h2 id="属性的声明"><a href="#属性的声明" class="headerlink" title="属性的声明"></a>属性的声明</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        Employee employee = <span class="keyword">new</span> Employee ();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Call the FirstName property's setter.</span></span><br><span class="line">        employee.FirstName = <span class="string">"Inigo"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Call the FirstName property's getter.</span></span><br><span class="line">        System.Console.WriteLine (employee.FirstName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span> &#123;</span><br><span class="line">    <span class="comment">// FirstName property</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> FirstName &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> _FirstName;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            _FirstName = <span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _FirstName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// LastName property</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> LastName &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> _LastName;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            _LastName = <span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _LastName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="自动实现的属性"><a href="#自动实现的属性" class="headerlink" title="自动实现的属性"></a>自动实现的属性</h2><p>从C# 3.0开始，属性语法有了简化版本，允许在声明属性时，不添加取值或赋值方法，也不声明任何支持地段。一切都将自动实现。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        Employee employee1 =</span><br><span class="line">            <span class="keyword">new</span> Employee ();</span><br><span class="line">        Employee employee2 =</span><br><span class="line">            <span class="keyword">new</span> Employee ();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Call the FirstName property's setter.</span></span><br><span class="line">        employee1.FirstName = <span class="string">"Inigo"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Call the FirstName property's getter.</span></span><br><span class="line">        System.Console.WriteLine (employee1.FirstName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Assign an auto-implemented property</span></span><br><span class="line">        employee2.Title = <span class="string">"Computer Nerd"</span>;</span><br><span class="line">        employee1.Manager = employee2;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Print employee1's manager's title.</span></span><br><span class="line">        System.Console.WriteLine (employee1.Manager.Title);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span> &#123;</span><br><span class="line">    <span class="comment">// FirstName property</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> FirstName &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> _FirstName;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            _FirstName = <span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _FirstName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// LastName property</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> LastName &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> _LastName;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            _LastName = <span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _LastName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Title property</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Title &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Manager property</span></span><br><span class="line">    <span class="keyword">public</span> Employee Manager &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="具有支持字段的属性-Properties-with-backing-fields"><a href="#具有支持字段的属性-Properties-with-backing-fields" class="headerlink" title="具有支持字段的属性 Properties with backing fields"></a>具有支持字段的属性 Properties with backing fields</h2><p>有一个实现属性的基本模式，该模式使用私有支持字段来设置和检索属性值。One basic pattern for implementing a property involves using a private backing field for setting and retrieving the property value. <code>get</code> 访问器返回私有字段的值，<code>set</code> 访问器在向私有字段赋值之前可能会执行一些数据验证。The <code>get</code> accessor returns the value of the private field, and the <code>set</code> accessor may perform some data validation before assigning a value to the private field. 这两个访问器还可以在存储或返回数据之前对其执行某些转换或计算。Both accessors may also perform some conversion or computation on the data before it is stored or returned.</p>
<p>下面的示例阐释了此模式。The following example illustrates this pattern. 在此示例中，<code>TimePeriod</code> 类表示时间间隔。In this example, the <code>TimePeriod</code> class represents an interval of time. 在内部，该类将时间间隔以秒为单位存储在名为 <code>seconds</code> 的私有字段中。Internally, the class stores the time interval in seconds in a private field named <code>seconds</code>. 名为 <code>Hours</code> 的读-写属性允许客户以小时为单位指定时间间隔。A read-write property named <code>Hours</code> allows the customer to specify the time interval in hours. <code>get</code> 和 <code>set</code> 访问器都会执行小时与秒之间的必要转换。Both the <code>get</code> and the <code>set</code> accessors perform the necessary conversion between hours and seconds. 此外，<code>set</code> 访问器还会验证数据，如果小时数无效，则引发 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.argumentoutofrangeexception" target="_blank" rel="noopener">ArgumentOutOfRangeException</a>。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">TimePeriod</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> seconds;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">double</span> Hours &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> seconds / <span class="number">3600</span>; &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">value</span> &lt; <span class="number">0</span> || <span class="keyword">value</span> &gt; <span class="number">24</span>)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentOutOfRangeException (</span><br><span class="line">                    <span class="string">$"<span class="subst">&#123;<span class="keyword">nameof</span>(<span class="keyword">value</span>)&#125;</span> must be between 0 and 24."</span>);</span><br><span class="line"></span><br><span class="line">            seconds = <span class="keyword">value</span> * <span class="number">3600</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        TimePeriod t = <span class="keyword">new</span> TimePeriod ();</span><br><span class="line">        <span class="comment">// The property assignment causes the 'set' accessor to be called.</span></span><br><span class="line">        t.Hours = <span class="number">24</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Retrieving the property causes the 'get' accessor to be called.</span></span><br><span class="line">        Console.WriteLine (<span class="string">$"Time in hours: <span class="subst">&#123;t.Hours&#125;</span>"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// The example displays the following output:</span></span><br><span class="line"><span class="comment">//    Time in hours: 24</span></span><br></pre></td></tr></table></figure>
<h2 id="表达式主体定义-Expression-body-definitions"><a href="#表达式主体定义-Expression-body-definitions" class="headerlink" title="表达式主体定义 Expression body definitions"></a>表达式主体定义 Expression body definitions</h2><p>属性访问器通常由单行语句组成，这些语句只分配或只返回表达式的结果。Property accessors often consist of single-line statements that just assign or return the result of an expression. 可以将这些属性作为 expression-bodied 成员来实现。You can implement these properties as expression-bodied members. <code>=&gt;</code> 符号后跟用于为属性赋值或从属性中检索值的表达式，即组成了表达式主体定义。Expression body definitions consist of the <code>=&gt;</code> symbol followed by the expression to assign to or retrieve from the property.</p>
<p>从 C# 6 开始，只读属性可以将 <code>get</code> 访问器作为 expression-bodied 成员实现。Starting with C# 6, read-only properties can implement the <code>get</code> accessor as an expression-bodied member. 在这种情况下，既不使用 <code>get</code> 访问器关键字，也不使用 <code>return</code> 关键字。In this case, neither the <code>get</code> accessor keyword nor the <code>return</code> keyword is used. 下面的示例将只读 <code>Name</code> 属性作为 expression-bodied 成员实现。The following example implements the read-only <code>Name</code> property as an expression-bodied member.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> firstName;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> lastName;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span> (<span class="params"><span class="keyword">string</span> first, <span class="keyword">string</span> last</span>) </span>&#123;</span><br><span class="line">        firstName = first;</span><br><span class="line">        lastName = last;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Name =&gt; <span class="string">$"<span class="subst">&#123;firstName&#125;</span> <span class="subst">&#123;lastName&#125;</span>"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Example</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> person = <span class="keyword">new</span> Person (<span class="string">"Isabelle"</span>, <span class="string">"Butts"</span>);</span><br><span class="line">        Console.WriteLine (person.Name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// The example displays the following output:</span></span><br><span class="line"><span class="comment">//      Isabelle Butts</span></span><br></pre></td></tr></table></figure>
<p>从 C# 7 开始，<code>get</code> 和 <code>set</code> 访问器都可以作为 expression-bodied 成员实现。Starting with C# 7, both the <code>get</code> and the <code>set</code> accessor can be implemented as expression-bodied members. 在这种情况下，必须使用 <code>get</code> 和 <code>set</code> 关键字。In this case, the <code>get</code> and <code>set</code> keywords must be present. 下面的示例阐释如何为这两个访问器使用表达式主体定义。The following example illustrates the use of expression body definitions for both accessors. 请注意，<code>return</code> 关键字不与 <code>get</code> 访问器搭配使用。Note that the <code>return</code> keyword is not used with the <code>get</code> accessor.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SaleItem</span> &#123;</span><br><span class="line">    <span class="keyword">string</span> name;</span><br><span class="line">    <span class="keyword">decimal</span> cost;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SaleItem</span> (<span class="params"><span class="keyword">string</span> name, <span class="keyword">decimal</span> cost</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.cost = cost;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Name &#123;</span><br><span class="line">        <span class="keyword">get</span> =&gt; name;</span><br><span class="line">        <span class="keyword">set</span> =&gt; name = <span class="keyword">value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">decimal</span> Price &#123;</span><br><span class="line">        <span class="keyword">get</span> =&gt; cost;</span><br><span class="line">        <span class="keyword">set</span> =&gt; cost = <span class="keyword">value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"><span class="keyword">string</span>[] args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> item = <span class="keyword">new</span> SaleItem (<span class="string">"Shoes"</span>, <span class="number">19.95</span>m);</span><br><span class="line">        Console.WriteLine (<span class="string">$"<span class="subst">&#123;item.Name&#125;</span>: sells for <span class="subst">&#123;item.Price:C2&#125;</span>"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// The example displays output like the following:</span></span><br><span class="line"><span class="comment">//       Shoes: sells for $19.95</span></span><br></pre></td></tr></table></figure>
<h2 id="只读和只写属性"><a href="#只读和只写属性" class="headerlink" title="只读和只写属性"></a>只读和只写属性</h2><p>省略 <code>set</code> 访问器可使属性为只读，省略 <code>get</code> 访问器可使属性为只写。只读属性对于任何赋值气度都会造成编译错误。例如，下例中是<code>Id</code>为只读：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        Employee employee1 = <span class="keyword">new</span> Employee ();</span><br><span class="line">        employee1.Initialize (<span class="number">42</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ERROR:  Property or indexer 'Employee.Id'</span></span><br><span class="line">        <span class="comment">// cannot be assigned to -- it is read-only</span></span><br><span class="line">        <span class="comment">//employee1.Id = "490";                     //will not compile if you uncomment this line</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Initialize</span> (<span class="params"><span class="keyword">int</span> id</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Use field because Id property has no setter,</span></span><br><span class="line">        <span class="comment">// it is read-only.</span></span><br><span class="line">        _Id = id.ToString ();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="comment">// Id property declaration</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Id &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> _Id;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// No setter provided.</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _Id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上例中采用Employee构造函数(而不是属性)对字段进行赋值（_Id = id）。如果通过属性来赋值，会造成编译错误。</p>
<h2 id="限制访问器可访问性（C-编程指南）Restricting-Accessor-Accessibility-C-Programming-Guide"><a href="#限制访问器可访问性（C-编程指南）Restricting-Accessor-Accessibility-C-Programming-Guide" class="headerlink" title="限制访问器可访问性（C# 编程指南）Restricting Accessor Accessibility (C# Programming Guide)"></a>限制访问器可访问性（C# 编程指南）Restricting Accessor Accessibility (C# Programming Guide)</h2><p>属性或索引器的 <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/get" target="_blank" rel="noopener">get</a> 和 <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/set" target="_blank" rel="noopener">set</a> 部分称为访问器。The <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/get" target="_blank" rel="noopener">get</a> and <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/set" target="_blank" rel="noopener">set</a> portions of a property or indexer are called <em>accessors</em>. 默认情况下，这些访问器具有相同的可见性或访问级别：其所属属性或索引器的可见性或访问级别。By default these accessors have the same visibility, or access level: that of the property or indexer to which they belong. 有关详细信息，请参阅<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/accessibility-levels" target="_blank" rel="noopener">可访问性级别</a>。For more information, see <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/accessibility-levels" target="_blank" rel="noopener">accessibility levels</a>. 不过，有时限制对其中某个访问器的访问是有益的。However, it is sometimes useful to restrict access to one of these accessors. 通常是在保持 <code>get</code> 访问器可公开访问的情况下，限制 <code>set</code> 访问器的可访问性。Typically, this involves restricting the accessibility of the <code>set</code> accessor, while keeping the <code>get</code> accessor publicly accessible.</p>
<p>可以为get或set部分指定访问修饰符（但不能为两者都指定），从而覆盖为属性声明指定的访问修饰符。例如:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        Employee employee1 = <span class="keyword">new</span> Employee ();</span><br><span class="line">        employee1.Initialize (<span class="number">42</span>);</span><br><span class="line">        <span class="comment">// ERROR: The property or indexer 'Employee.Id'</span></span><br><span class="line">        <span class="comment">// cannot be used in this context because the set</span></span><br><span class="line">        <span class="comment">// accessor is inaccessible</span></span><br><span class="line">        <span class="comment">//employee1.Id = "490";                     //will not compile if you uncomment this line</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Initialize</span> (<span class="params"><span class="keyword">int</span> id</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Set Id property</span></span><br><span class="line">        Id = id.ToString ();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="comment">// Id property declaration</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Id &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> _Id;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Providing an access modifier is in C# 2.0</span></span><br><span class="line">        <span class="comment">// and higher only</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">set</span> &#123;</span><br><span class="line">            _Id = <span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _Id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>为赋值方法指定private修饰符后，属性对于处Employee之外的其他类来说是只读的。在Employee类内部，属性是可读/可写的，所以可在构造器中对属性进行赋值。为取值方法或赋值方法指定访问修饰符时，注意该访问修饰符的“限制性”必须比应用于整个属相的访问修饰符更“严格”。例如，属性声明为较为严格的private，但将它的赋值方法声明为较宽松的public，就会发生编译错误。</p>
<h2 id="属性作为虚字段使用"><a href="#属性作为虚字段使用" class="headerlink" title="属性作为虚字段使用"></a>属性作为虚字段使用</h2><p>下例中，Name属性的实现：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        Employee employee1 = <span class="keyword">new</span> Employee ();</span><br><span class="line"></span><br><span class="line">        employee1.Name = <span class="string">"Inigo Montoya"</span>;</span><br><span class="line">        System.Console.WriteLine (employee1.Name);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span> &#123;</span><br><span class="line">    <span class="comment">// FirstName property</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> FirstName &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> _FirstName;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            _FirstName = <span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _FirstName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// LastName property</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> LastName &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> _LastName;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            _LastName = <span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _LastName;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Name property</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Name &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> FirstName + <span class="string">" "</span> + LastName;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            <span class="comment">// Split the assigned value into </span></span><br><span class="line">            <span class="comment">// first and last names.</span></span><br><span class="line">            <span class="keyword">string</span>[] names;</span><br><span class="line">            names = <span class="keyword">value</span>.Split (<span class="keyword">new</span> <span class="keyword">char</span>[] &#123; <span class="string">' '</span> &#125;);</span><br><span class="line">            <span class="keyword">if</span> (names.Length == <span class="number">2</span>) &#123;</span><br><span class="line">                FirstName = names[<span class="number">0</span>];</span><br><span class="line">                LastName = names[<span class="number">1</span>];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// Throw an exception if the full </span></span><br><span class="line">                <span class="comment">// name was not assigned.</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> System.ArgumentException (</span><br><span class="line">                    <span class="keyword">string</span>.Format (</span><br><span class="line">                        <span class="string">"Assigned value '&#123;0&#125;' is invalid"</span>, <span class="keyword">value</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Title property</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Title &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Manager property</span></span><br><span class="line">    <span class="keyword">public</span> Employee Manager &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="构造器-Constructors-构造函数"><a href="#构造器-Constructors-构造函数" class="headerlink" title="构造器 Constructors (构造函数)"></a>构造器 Constructors (构造函数)</h1><p>每当创建<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/class" target="_blank" rel="noopener">类</a>或<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/struct" target="_blank" rel="noopener">结构</a>时，将会调用其构造函数。Whenever a <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/class" target="_blank" rel="noopener">class</a> or <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/struct" target="_blank" rel="noopener">struct</a> is created, its constructor is called. 类或结构可能具有采用不同参数的多个构造函数。A class or struct may have multiple constructors that take different arguments. 使用构造函数，程序员能够设置默认值、限制实例化，并编写灵活易读的代码。Constructors enable the programmer to set default values, limit instantiation, and write code that is flexible and easy to read. 有关详细信息和示例，请参阅<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/programming-guide/classes-and-structs/using-constructors" target="_blank" rel="noopener">使用构造函数</a>和<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/programming-guide/classes-and-structs/instance-constructors" target="_blank" rel="noopener">实例构造函数</a>。</p>
<h2 id="构造函数声明与调用"><a href="#构造函数声明与调用" class="headerlink" title="构造函数声明与调用"></a>构造函数声明与调用</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Employee constructor</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span>(<span class="params"><span class="keyword">string</span> firstName, <span class="keyword">string</span> lastName</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        FirstName = firstName;</span><br><span class="line">        LastName = lastName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> FirstName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> LastName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">｝</span><br></pre></td></tr></table></figure>
<p>构造函数是一种<code>方法</code>，其名称与其<code>类名``完全相同</code>。 其方法签名仅包含方法名称和其参数列表；它<code>没有返回类型</code>。构造函数是“运行时”用来初始化对象实例的方法。在此例中，构造函数以员工的名字和姓氏作为参数，允许程序员在实例化Employee对象时制定这些参数的值。如下例：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Employee employee;</span><br><span class="line">        employee = <span class="keyword">new</span> Employee(<span class="string">"Inigo"</span>, <span class="string">"Montoya"</span>);</span><br><span class="line">        employee.Salary = <span class="string">"Too Little"</span>;</span><br><span class="line"></span><br><span class="line">        System.Console.WriteLine(</span><br><span class="line">            <span class="string">"&#123;0&#125; &#123;1&#125;: &#123;2&#125;"</span>,</span><br><span class="line">            employee.FirstName,</span><br><span class="line">            employee.LastName,</span><br><span class="line">            employee.Salary);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果某个构造函数可以作为单个语句实现，则可以使用<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/programming-guide/statements-expressions-operators/expression-bodied-members" target="_blank" rel="noopener">表达式主体定义</a>。If a constructor can be implemented as a single statement, you can use an <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/programming-guide/statements-expressions-operators/expression-bodied-members" target="_blank" rel="noopener">expression body definition</a>. 以下示例定义 <code>Location</code> 类，其构造函数具有一个名为“name”的字符串参数。The following example defines a <code>Location</code> class whose constructor has a single string parameter named <em>name</em>. 表达式主体定义给 <code>locationName</code> 字段分配参数。The expression body definition assigns the argument to the <code>locationName</code> field.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Location</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">string</span> locationName;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Location</span>(<span class="params"><span class="keyword">string</span> name</span>) </span>=&gt; locationName = name;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">string</span> Name</span><br><span class="line">   &#123;</span><br><span class="line">      <span class="keyword">get</span> =&gt; locationName;</span><br><span class="line">      <span class="keyword">set</span> =&gt; locationName = <span class="keyword">value</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="默认构造器-Default-constructors"><a href="#默认构造器-Default-constructors" class="headerlink" title="默认构造器 Default constructors"></a>默认构造器 Default constructors</h2><p>如果没有为类提供构造函数，默认情况下，C# 将创建一个会实例化对象并将成员变量设置为默认值的构造函数，如<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/default-values-table" target="_blank" rel="noopener">默认值表</a>中所列。If you don’t provide a constructor for your class, C# creates one by default that instantiates the object and sets member variables to the default values as listed in the <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/default-values-table" target="_blank" rel="noopener">Default Values Table</a>. 如果没有为结构提供构造函数，C# 将依赖于隐式默认构造函数，自动将值类型的每个字段初始化为其默认值，如<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/default-values-table" target="_blank" rel="noopener">默认值表</a>中所列。If you don’t provide a constructor for your struct, C# relies on an <em>implicit default constructor</em> to automatically initialize each field of a value type to its default value as listed in the <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/default-values-table" target="_blank" rel="noopener">Default Values Table</a>. 有关详细信息和示例，请参阅<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/programming-guide/classes-and-structs/instance-constructors" target="_blank" rel="noopener">实例构造函数</a>。</p>
<h2 id="对象初始化器-Object-Initializer"><a href="#对象初始化器-Object-Initializer" class="headerlink" title="对象初始化器 Object Initializer"></a>对象初始化器 Object Initializer</h2><p>可以使用<code>对象初始值设定项</code>(对象初始化器)以声明方式初始化类型对象，而无需显式调用类型的构造函数。You can use object initializers to initialize type objects in a declarative manner without explicitly invoking a constructor for the type.</p>
<p>以下示例演示如何将<code>对象初始化器</code>用于命名对象。The following examples show how to use object initializers with named objects. 编译器通过首先访问默认实例构造函数，然后处理成员初始化来处理对象初始值设定项。The compiler processes object initializers by first accessing the default instance constructor and then processing the member initializations. 因此，如果默认构造函数在类中声明为 <code>private</code>，则需要公共访问的对象初始值设定项将失败。Therefore, if the default constructor is declared as <code>private</code> in the class, object initializers that require public access will fail.</p>
<p>如果要定义匿名类型，则必须使用<code>对象初始化器</code>。You must use an object initializer if you’re defining an anonymous type. 有关详细信息，请参阅<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/programming-guide/classes-and-structs/how-to-return-subsets-of-element-properties-in-a-query" target="_blank" rel="noopener">如何：在查询中返回元素属性的子集</a>。For more information, see <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/programming-guide/classes-and-structs/how-to-return-subsets-of-element-properties-in-a-query" target="_blank" rel="noopener">How to: Return Subsets of Element Properties in a Query</a>.</p>
<p>下面的示例演示如何使用<code>对象初始化器</code>初始化新的 <code>StudentName</code> 类型。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Declare a StudentName by using the constructor that has two parameters.</span></span><br><span class="line">        StudentName student1 = <span class="keyword">new</span> StudentName (<span class="string">"Craig"</span>, <span class="string">"Playstead"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Make the same declaration by using an object initializer and sending </span></span><br><span class="line">        <span class="comment">// arguments for the first and last names. The default constructor is </span></span><br><span class="line">        <span class="comment">// invoked in processing this declaration, not the constructor that has</span></span><br><span class="line">        <span class="comment">// two parameters.</span></span><br><span class="line">        StudentName student2 = <span class="keyword">new</span> StudentName &#123;</span><br><span class="line">            FirstName = <span class="string">"Craig"</span>,</span><br><span class="line">            LastName = <span class="string">"Playstead"</span>,</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Declare a StudentName by using an object initializer and sending</span></span><br><span class="line">        <span class="comment">// an argument for only the ID property. No corresponding constructor is</span></span><br><span class="line">        <span class="comment">// necessary. Only the default constructor is used to process object</span></span><br><span class="line">        <span class="comment">// initializers.</span></span><br><span class="line">        StudentName student3 = <span class="keyword">new</span> StudentName &#123;</span><br><span class="line">            ID = <span class="number">183</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Declare a StudentName by using an object initializer and sending</span></span><br><span class="line">        <span class="comment">// arguments for all three properties. No corresponding constructor is</span></span><br><span class="line">        <span class="comment">// defined in the class.</span></span><br><span class="line">        StudentName student4 = <span class="keyword">new</span> StudentName &#123;</span><br><span class="line">            FirstName = <span class="string">"Craig"</span>,</span><br><span class="line">            LastName = <span class="string">"Playstead"</span>,</span><br><span class="line">            ID = <span class="number">116</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        System.Console.WriteLine (student1.ToString ());</span><br><span class="line">        System.Console.WriteLine (student2.ToString ());</span><br><span class="line">        System.Console.WriteLine (student3.ToString ());</span><br><span class="line">        System.Console.WriteLine (student4.ToString ());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Output:</span></span><br><span class="line">    <span class="comment">// Craig  0</span></span><br><span class="line">    <span class="comment">// Craig  0</span></span><br><span class="line">    <span class="comment">//   183</span></span><br><span class="line">    <span class="comment">// Craig  116</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">StudentName</span> &#123;</span><br><span class="line">    <span class="comment">// The default constructor has no parameters. The default constructor</span></span><br><span class="line">    <span class="comment">// is invoked in the processing of object initializers.</span></span><br><span class="line">    <span class="comment">// You can test this by changing the access modifier from public to</span></span><br><span class="line">    <span class="comment">// private. The declarations in Main that use object initializers will</span></span><br><span class="line">    <span class="comment">// fail.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StudentName</span> (<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The following constructor has parameters for two of the three</span></span><br><span class="line">    <span class="comment">// properties.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StudentName</span> (<span class="params"><span class="keyword">string</span> first, <span class="keyword">string</span> last</span>) </span>&#123;</span><br><span class="line">        FirstName = first;</span><br><span class="line">        LastName = last;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Properties.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> FirstName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> LastName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> ID &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">string</span> <span class="title">ToString</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> FirstName + <span class="string">"  "</span> + ID;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下面的示例演示如何使用<code>集合初始化器</code>来初始化 <code>StudentName</code> 类型的集合。The following example shows how to initialize a collection of <code>StudentName</code> types by using a collection initializer. 请注意，集合初始值设定项是一系列由逗号分隔的对象初始值设定项。Note that a collection initializer is a series of comma-separated object initializers.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">List&lt;StudentName&gt; students = <span class="keyword">new</span> List&lt;StudentName&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> StudentName &#123;FirstName=<span class="string">"Craig"</span>, LastName=<span class="string">"Playstead"</span>, ID=<span class="number">116</span>&#125;,</span><br><span class="line">  <span class="keyword">new</span> StudentName &#123;FirstName=<span class="string">"Shu"</span>, LastName=<span class="string">"Ito"</span>, ID=<span class="number">112</span>&#125;,</span><br><span class="line">  <span class="keyword">new</span> StudentName &#123;FirstName=<span class="string">"Gretchen"</span>, LastName=<span class="string">"Rivas"</span>, ID=<span class="number">113</span>&#125;,</span><br><span class="line">  <span class="keyword">new</span> StudentName &#123;FirstName=<span class="string">"Rajesh"</span>, LastName=<span class="string">"Rotti"</span>, ID=<span class="number">114</span>&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="终结器-Finalizers"><a href="#终结器-Finalizers" class="headerlink" title="终结器 Finalizers"></a>终结器 Finalizers</h2><p>终结器用于析构类的实例。Finalizers are used to destruct instances of classes.</p>
<blockquote>
<p>备注 Remarks</p>
</blockquote>
<ul>
<li><p>无法在结构中定义终结器。Finalizers cannot be defined in structs. 它们仅用于类。They are only used with classes.</p>
</li>
<li><p>一个类只能有一个终结器。A class can only have one finalizer.</p>
</li>
<li><p>不能继承或重载终结器。Finalizers cannot be inherited or overloaded.</p>
</li>
<li><p>不能手动调用终结器。Finalizers cannot be called. 可以自动调用它们。They are invoked automatically.</p>
</li>
<li><p>终结器不使用修饰符或参数。</p>
</li>
</ul>
<p>例如，以下是类 <code>Car</code> 的终结器声明。For example, the following is a declaration of a finalizer for the <code>Car</code> class.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Car</span></span><br><span class="line">&#123;</span><br><span class="line">    ~Car()  <span class="comment">// destructor</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// cleanup statements...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>终结器也可以作为表达式主体定义实现，如下面的示例所示。A finalizer can also be implemented as an expression body definition, as the following example shows.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Destroyer</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">string</span> <span class="title">ToString</span>(<span class="params"></span>) </span>=&gt; GetType().Name;</span><br><span class="line"></span><br><span class="line">   ~Destroyer() =&gt; Console.WriteLine(<span class="string">$"The <span class="subst">&#123;ToString()&#125;</span> destructor is executing."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>程序员无法控制何时调用终结器，因为这由垃圾回收器决定。The programmer has no control over when the finalizer is called because this is determined by the garbage collector. 垃圾回收器检查应用程序不再使用的对象。The garbage collector checks for objects that are no longer being used by the application. 如果它认为某个对象符合终止条件，则调用终结器（如果有），并回收用来存储此对象的内存。If it considers an object eligible for finalization, it calls the finalizer (if any) and reclaims the memory used to store the object. 还可在程序退出后调用终结器。Finalizers are also called when the program exits.</p>
<p>可以通过调用 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.gc.collect" target="_blank" rel="noopener">Collect</a> 强制进行垃圾回收，但多数情况下应避免此操作，因为它可能会造成性能问题。</p>
<h2 id="构造器的重载"><a href="#构造器的重载" class="headerlink" title="构造器的重载"></a>构造器的重载</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Employee</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span> (<span class="params"><span class="keyword">string</span> firstName, <span class="keyword">string</span> lastName</span>) </span>&#123;</span><br><span class="line">        FirstName = firstName;</span><br><span class="line">        LastName = lastName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">int</span> id, <span class="keyword">string</span> firstName, <span class="keyword">string</span> lastName</span>) </span>&#123;</span><br><span class="line">        Id = id;</span><br><span class="line">        FirstName = firstName;</span><br><span class="line">        LastName = lastName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span> (<span class="params"><span class="keyword">int</span> id</span>) </span>&#123;</span><br><span class="line">        Id = id;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Look up employee name...</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> FirstName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> LastName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>应优先使用可选参数而不是重载，以便在API中清楚地看出“默认”属性的默认值。例如，Person的一个构造器签名Person（string firstName, string lastName, int? age = null）就清楚地指明如果Person的Age未指定，就将它默认为null。</p>
<h2 id="构造器链：使用this调用另一个构造器"><a href="#构造器链：使用this调用另一个构造器" class="headerlink" title="构造器链：使用this调用另一个构造器"></a>构造器链：使用this调用另一个构造器</h2><p>上例中，对Employee对象进行初始化的代码多处重复，可以从一个构造器中调用另一个构造器，避免重复输入代码。这称为<strong>构造器链</strong>，它是用<strong>构造器初始化器</strong>来实现的。C#采用的语法格式是在一个冒号后面添加this关键字，再添加被调用构造器的参数列表。构造器初始化器在自行当前的构造器实现之前，判断要调用另外哪一个构造器，实例如下：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Employee</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span> (<span class="params"><span class="keyword">string</span> firstName, <span class="keyword">string</span> lastName</span>) </span>&#123;</span><br><span class="line">        FirstName = firstName;</span><br><span class="line">        LastName = lastName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">int</span> id, <span class="keyword">string</span> firstName, <span class="keyword">string</span> lastName</span>) : <span class="title">this</span> (<span class="params">firstName, lastName</span>) </span>&#123;</span><br><span class="line">        Id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span> (<span class="params"><span class="keyword">int</span> id</span>) </span>&#123;</span><br><span class="line">        Id = id;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Look up employee name...</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// <span class="doctag">NOTE:</span>  Member constructors cannot be </span></span><br><span class="line">        <span class="comment">// called explicitly inline</span></span><br><span class="line">        <span class="comment">// this(id, firstName, lastName);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> FirstName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> LastName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上例中，3个参数的构造器调用2个参数的构造器。通常情况下，用参数最少的构造器调用参数最多的构造器，为位置的参数传递默认值。如下例：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Employee</span>(<span class="params"><span class="keyword">int</span> id</span>):<span class="title">this</span>(<span class="params">id,<span class="string">""</span>,<span class="string">""</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">string</span> firstName;</span><br><span class="line">    <span class="keyword">string</span> lastName;</span><br><span class="line">    Id = id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检索、组合Employee数据</span></span><br><span class="line">    firstName = <span class="keyword">string</span>.Empty;</span><br><span class="line">    lastName = <span class="keyword">string</span>.Empty;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    Initialize(id, firstName, lastName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>构造器链</code>完整例子参考：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Person</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> personName;</span><br><span class="line">    <span class="comment">//定义年龄为可空类型,这样就可以赋予其null值</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>? personAge;</span><br><span class="line">    <span class="comment">//下面前三个构造函数都是去调用参数最多的第四个构造函数,只取它们所需要的部分参数即可</span></span><br><span class="line">    <span class="comment">//这样的做法就是this串联构造函数</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span> (<span class="params"></span>) : <span class="title">this</span> (<span class="params"><span class="string">""</span>, <span class="number">0</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span> (<span class="params"><span class="keyword">string</span> name</span>) : <span class="title">this</span> (<span class="params">name, <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span> (<span class="params"><span class="keyword">int</span> age</span>) : <span class="title">this</span> (<span class="params"><span class="string">""</span>, age</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span> (<span class="params"><span class="keyword">string</span> name, <span class="keyword">int</span>? age</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.personName = name;</span><br><span class="line">        <span class="comment">//通过 ?? 判断传入的age是否null值</span></span><br><span class="line">        <span class="comment">//如果属于null值,则赋值100</span></span><br><span class="line">        <span class="keyword">this</span>.personAge = age ?? <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Display</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        Console.WriteLine (<span class="string">"Name:&#123;0&#125;,Age:&#123;1&#125;"</span>, personName, personAge);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Hello</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"><span class="keyword">string</span>[] args</span>) </span>&#123;</span><br><span class="line">        Person per1 = <span class="keyword">new</span> Person ();</span><br><span class="line">        per1.Display ();</span><br><span class="line">        Person per2 = <span class="keyword">new</span> Person (<span class="number">20</span>);</span><br><span class="line">        per2.Display ();</span><br><span class="line">        Person per3 = <span class="keyword">new</span> Person (<span class="string">"evan"</span>);</span><br><span class="line">        per3.Display ();</span><br><span class="line">        Person per4 = <span class="keyword">new</span> Person (<span class="string">"evan"</span>, <span class="number">20</span>);</span><br><span class="line">        per4.Display ();</span><br><span class="line">        Console.ReadKey ();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="初学者主题：集中初始化"><a href="#初学者主题：集中初始化" class="headerlink" title="初学者主题：集中初始化"></a>初学者主题：集中初始化</h2><p>创建单独的方法，将所有初始化代码集中在一起，如下例中，创建名为Initialize()方法，它同时获取员工的名字、姓氏和ID。示例如下：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Employee</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span> (<span class="params"><span class="keyword">string</span> firstName, <span class="keyword">string</span> lastName</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> id;</span><br><span class="line">        <span class="comment">// Generate an employee ID...</span></span><br><span class="line">        id = <span class="number">0</span>; <span class="comment">// id needs to be initialized for this example</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        Initialize (id, firstName, lastName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span> (<span class="params"><span class="keyword">int</span> id, <span class="keyword">string</span> firstName, <span class="keyword">string</span> lastName</span>) </span>&#123;</span><br><span class="line">        Initialize (id, firstName, lastName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span> (<span class="params"><span class="keyword">int</span> id</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">string</span> firstName;</span><br><span class="line">        <span class="keyword">string</span> lastName;</span><br><span class="line">        Id = id;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Look up employee data</span></span><br><span class="line">        firstName = <span class="keyword">string</span>.Empty;</span><br><span class="line">        lastName = <span class="keyword">string</span>.Empty;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">        Initialize (id, firstName, lastName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Initialize</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">int</span> id, <span class="keyword">string</span> firstName, <span class="keyword">string</span> lastName</span>) </span>&#123;</span><br><span class="line">        Id = id;</span><br><span class="line">        FirstName = firstName;</span><br><span class="line">        LastName = lastName;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> FirstName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> LastName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="未完成"><a href="#未完成" class="headerlink" title="未完成"></a>未完成</h1><iframe src="http://slowread.cn/EssentialCSharp5-Index.html" width="100%" height="300" frameborder="0" allowfullscreen></iframe>
      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.png" alt="At2008 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.png" alt="At2008 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    At2008
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://slowread.cn/2017/12/22/CSharp本质论笔记-第5章-类/" title="C#本质论笔记 第5章 类">http://slowread.cn/2017/12/22/CSharp本质论笔记-第5章-类/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/C/" rel="tag"><i class="fa fa-tag"></i> C#</a>
          
            <a href="/tags/C-本质论/" rel="tag"><i class="fa fa-tag"></i> C#本质论</a>
          
            <a href="/tags/Essential-C/" rel="tag"><i class="fa fa-tag"></i> Essential C#</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/12/19/Windows-系统常用工具软件/" rel="next" title="Windows 系统常用工具软件">
                <i class="fa fa-chevron-left"></i> Windows 系统常用工具软件
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zMjM4NS84OTQ2"></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="At2008" />
            
              <p class="site-author-name" itemprop="name">At2008</p>
              <p class="site-description motion-element" itemprop="description">心存善念 随心而动</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/at2008" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://twitter.com/wanow" target="_blank" title="Twitter">
                    
                      <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                </span>
              
            
          </div>

          
          

          
          

          
        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#类的定义和实例化"><span class="nav-number">1.</span> <span class="nav-text">类的定义和实例化</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#this-关键字"><span class="nav-number">2.</span> <span class="nav-text">this 关键字</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#高级主题：存储和载入文件"><span class="nav-number">3.</span> <span class="nav-text">高级主题：存储和载入文件</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#将数据持久化存储到文件"><span class="nav-number">3.1.</span> <span class="nav-text">将数据持久化存储到文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#从文件中获取数据"><span class="nav-number">3.2.</span> <span class="nav-text">从文件中获取数据</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#访问修饰符-Access-Modifiers"><span class="nav-number">4.</span> <span class="nav-text">访问修饰符 Access Modifiers</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#属性"><span class="nav-number">5.</span> <span class="nav-text">属性</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#示例Example"><span class="nav-number">5.1.</span> <span class="nav-text">示例Example</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#属性的声明"><span class="nav-number">5.2.</span> <span class="nav-text">属性的声明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#自动实现的属性"><span class="nav-number">5.3.</span> <span class="nav-text">自动实现的属性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#具有支持字段的属性-Properties-with-backing-fields"><span class="nav-number">5.4.</span> <span class="nav-text">具有支持字段的属性 Properties with backing fields</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#表达式主体定义-Expression-body-definitions"><span class="nav-number">5.5.</span> <span class="nav-text">表达式主体定义 Expression body definitions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#只读和只写属性"><span class="nav-number">5.6.</span> <span class="nav-text">只读和只写属性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#限制访问器可访问性（C-编程指南）Restricting-Accessor-Accessibility-C-Programming-Guide"><span class="nav-number">5.7.</span> <span class="nav-text">限制访问器可访问性（C# 编程指南）Restricting Accessor Accessibility (C# Programming Guide)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#属性作为虚字段使用"><span class="nav-number">5.8.</span> <span class="nav-text">属性作为虚字段使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#构造器-Constructors-构造函数"><span class="nav-number">6.</span> <span class="nav-text">构造器 Constructors (构造函数)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#构造函数声明与调用"><span class="nav-number">6.1.</span> <span class="nav-text">构造函数声明与调用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#默认构造器-Default-constructors"><span class="nav-number">6.2.</span> <span class="nav-text">默认构造器 Default constructors</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#对象初始化器-Object-Initializer"><span class="nav-number">6.3.</span> <span class="nav-text">对象初始化器 Object Initializer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#终结器-Finalizers"><span class="nav-number">6.4.</span> <span class="nav-text">终结器 Finalizers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#构造器的重载"><span class="nav-number">6.5.</span> <span class="nav-text">构造器的重载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#构造器链：使用this调用另一个构造器"><span class="nav-number">6.6.</span> <span class="nav-text">构造器链：使用this调用另一个构造器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#初学者主题：集中初始化"><span class="nav-number">6.7.</span> <span class="nav-text">初学者主题：集中初始化</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#未完成"><span class="nav-number">7.</span> <span class="nav-text">未完成</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2015 &mdash; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">At2008</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io" rel="external nofollow">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">NexT.Pisces</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("2ORDMbnSfXg1N3gmb3TKdyYY-gzGzoHsz", "RL4XjIatmuQbBWvJzPc5a3d4");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  

</body>
</html>
